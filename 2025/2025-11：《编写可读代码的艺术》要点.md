# 《编写可读代码的艺术》要点

1. 可读性基本原理：代码的写法应当使别人理解所需的时间最小化。

2. 什么叫理解代码？别人可以改动它、找出缺陷，并知道其和其他部分的交互方式。

3. 选择专业和无歧义的词做变量名。如，getPage，如果是从互联网中，则用download或fetch更合适。Stop，根据是否可恢复，改为Kill、Pause或者Resume。避免令人无解的名字，如filter（不确定是过滤还是筛选）。

4. 计数变量具体化。如，i→user_i。

5. 度量变量加单位。如，毫秒_ms。

6. 类型变量加标识。如，指针p_，映射m_。

7. 如果作用域很小，可以使用简单的名字。如，ijk。

8. 如何确定是否用首字母还是全拼？如果确定团队新人能看懂首字母，就首字母。

9. 名字的格式：类名-驼峰。变量名-下划线。类变量-末尾下划线。宏定义-全大写+下划线。

10. 范围变量：不要用limit，用min和max更明确。first第一个包含，last最后一个包含，begin第一个包含，end最后一个排除。

11. 布尔变量，加上is、has、can、should，明确意义。同时避免使用反义。

12. 函数名字设计要考虑他人是否会滥用。如果是getX()，会频繁调用。改为computeX()更好。

13. 横排注释，适合注释参数。

    ```c++
    TcpConnectionSimulator(throughput, latency, jitter, packet_loss)
    						// [Kbps]       [ms]   [ms]     [percent]
    ```

14. 一大堆相同内涵的定义，使用列对齐。顺序按某一规则，如重要性从高到底、分组。

15. 写什么注释

    1. 不要写做了什么，要写为什么这么做。

    2. 写见解，比如当时这样写是怎么考虑的，有助于他人理解。

    3. 写标记，TODO（未完成），FIXME（已知缺陷），HACK（粗糙方案），XXX（危险代码）。

    4. 经过特殊挑选的参数值要注解，帮助别人判断是否该改动。

    5. 注释要精确，比如处理字符串，是否包含末尾\n？

    6. 对于不支持命名参数的语言，这样做：

       ```c++
       // Call the function with commented parameters
       Connect(/* timeout_ms = */ 10, /* use_encryption = */ fallse);
       ```

16. if/else

    1. 先处理正逻辑，再处理负逻辑。
    2. 先处理简单情况，再处理复杂情况。这样if和else的代码可以共视。
    3. 先处理有趣和可疑情况。
    4. 极为简单情况才采用三目运算符。
    5. 如何减少嵌套？提前返回（continue或return）。

17. 解释变量，将一个很长的判断表达式，变成一个变量。总结变量，返回值。

18. 尽量少用控制流变量，如done、bret。尽可能优化控制结构。

19. 尽量减小变量的作用域。

20. 决定是否抽取函数：

    1. 用自然语言描述流程，一句话做一件事（输入，过程，输出），自然就拆分出各种函数了。
    2. 通用的、可复用的，应该抽取。
    3. 对某一操作的前处理、后处理，应该抽取。

21. 少写多看。每隔一段时间，读一读标准库文档。这样可以不反复造轮子。

22. 将测试代码按quick_start标准写。因为有的人把它当教程用。

23. 测试数据要有典型性。如，非常负的值，直接写-1e100。